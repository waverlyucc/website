{"version":3,"sources":["dashboard-widget.js"],"names":["require","undefined","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","1","module","getRememberedValues","previouslySelectedListValue","localStorage","getItem","listSelector","value","previouslySelectedViewValue","viewSelector","previouslySelectedPeriodValue","periodSelector","rememberValues","setItem","getRowData","rows","$","getJSON","ajaxurl","action","mailchimp_list_id","period","view","res","data","chartElement","innerHTML","v","Date","drawChart","chart","options","hAxis","title","format","vAxis","explorer","maxZoomOut","keepInBounds","animation","duration","easing","startup","height","SizeChart","ActivityChart","draw","google","visualization","ColumnChart","DataTable","addColumn","addRows","isStacked","selectedIndex","charts","Line","legend","position","window","jQuery","document","getElementById","onchange","load","packages","setOnLoadCallback"],"mappings":"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","file":"dashboard-widget.min.js","sourcesContent":["(function () { var require = undefined; var define = undefined; (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n// vars\nvar $ = window.jQuery;\nvar rows = [];\nvar listSelector = document.getElementById('mc4wp-activity-mailchimp-list');\nvar chartElement = document.getElementById(\"mc4wp-activity-chart\");\nvar viewSelector = document.getElementById('mc4wp-activity-view');\nvar periodSelector = document.getElementById('mc4wp-activity-period');\n\n// init\nviewSelector.onchange = getRowData;\nlistSelector.onchange = getRowData;\nperiodSelector.onchange = getRowData;\n\ngetRememberedValues();\ngoogle.load('visualization', '1', {packages: ['corechart', 'bar', 'line']});\ngoogle.setOnLoadCallback(getRowData);\n\n\n// functions\nfunction getRememberedValues() {\n\tvar previouslySelectedListValue = localStorage.getItem('mc4wp_activity_list');\n\tif( typeof( previouslySelectedListValue ) === \"string\" && previouslySelectedListValue.length ) {\n\t\tlistSelector.value = previouslySelectedListValue;\n\t}\n\n\tvar previouslySelectedViewValue = localStorage.getItem('mc4wp_activity_view');\n\tif( typeof( previouslySelectedViewValue ) === \"string\" && previouslySelectedViewValue.length ) {\n\t\tviewSelector.value = previouslySelectedViewValue;\n\t}\n\n\tvar previouslySelectedPeriodValue = localStorage.getItem('mc4wp_activity_period');\n\tif( previouslySelectedPeriodValue && previouslySelectedPeriodValue.length ) {\n\t\tperiodSelector.value = previouslySelectedPeriodValue;\n\t}\n}\n\nfunction rememberValues() {\n\tlocalStorage.setItem( 'mc4wp_activity_list', listSelector.value );\n\tlocalStorage.setItem( 'mc4wp_activity_view', viewSelector.value );\n\tlocalStorage.setItem( 'mc4wp_activity_period', periodSelector.value );\n}\n\n\nfunction getRowData() {\n\n\t// restore data\n\trows = [];\n\n\trememberValues();\n\n\t$.getJSON( ajaxurl, {\n\t\taction: 'mc4wp_get_activity',\n\t\tmailchimp_list_id: listSelector.value,\n\t\tperiod: periodSelector.value,\n\t\tview: viewSelector.value\n\t}, function( res ) {\n\t\trows = res.data;\n\n\t\tif( ! res.data || ! res.data.length ) {\n\t\t\t// @todo make this translatable\n\t\t\tchartElement.innerHTML = 'Oops. Something went wrong while fetching data from MailChimp.';\n\t\t\treturn;\n\t\t}\n\n\t\tfor( var i=0; i< rows.length; i++ ) {\n\t\t\t// convert strings to JavaScript Date object\n\t\t\trows[i][0].v = new Date(rows[i][0].v);\n\t\t}\n\n\t\tdrawChart();\n\t});\n}\n\nfunction drawChart() {\n\n\tvar chart;\n\tvar options = {\n\t\thAxis: {\n\t\t\ttitle: 'Date',\n\t\t\tformat: 'MMM d'\n\t\t},\n\t\tvAxis: {},\n\t\texplorer: {\n\t\t\tmaxZoomOut:2,\n\t\t\tkeepInBounds: true\n\t\t},\n\t\tanimation: {\n\t\t\tduration: 1000,\n\t\t\teasing: 'linear',\n\t\t\tstartup: true\n\t\t},\n\t\theight: 400\n\t};\n\n\tif( viewSelector.value === 'size' ) {\n\t\tchart = new SizeChart( rows, options );\n\t} else {\n\t\tchart = new ActivityChart( rows, options );\n\t}\n\n\tchart.draw();\n}\n\n\n\nfunction ActivityChart( rows, options ) {\n\n\tvar data = new google.visualization.DataTable();\n\tdata.addColumn('date', 'Date');\n\tdata.addColumn('number', 'New Subscribers');\n\tdata.addColumn('number', 'Unsubscribes');\n\tdata.addRows(rows);\n\n\toptions.isStacked = true;\n\toptions.title = 'Activity for list ' + listSelector.options[listSelector.selectedIndex].innerHTML;\n\toptions.vAxis.title = \"Subscriber Activity\";\n\n\tfunction draw() {\n\t\tvar chart = new google.visualization.ColumnChart(chartElement);\n\t\tchart.draw(data, options);\n\t}\n\n\treturn {\n\t\tdraw: draw\n\t}\n\n}\n\nfunction SizeChart( rows, options ) {\n\n\tvar data = new google.visualization.DataTable();\n\tdata.addColumn('date', 'Date');\n\tdata.addColumn('number', 'Subscribers');\n\tdata.addRows(rows);\n\n\toptions.title = \"List size for list \" + listSelector.options[listSelector.selectedIndex].innerHTML;\n\toptions.vAxis.title = \"Number of Subscribers\";\n\toptions.legend = { position: 'none' };\n\n\tfunction draw() {\n\t\tvar chart = new google.charts.Line(chartElement);\n\t\tchart.draw(data, options);\n\t}\n\n\treturn {\n\t\tdraw: draw\n\t}\n}\n},{}]},{},[1]);\n })();"]}